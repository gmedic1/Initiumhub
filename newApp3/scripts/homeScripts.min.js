var isValidName, isValidEmail, isValidPhoneNumber, globalEmail; function validateName(e) { return new RegExp(/^[a-z\-\'\s]+$/i).test(e) ? ($("#txtLastName").next().removeClass("ion-alert-circled"), isValidName = !0, !0) : ($("#txtLastName").addClass("ion-alert-circled"), isValidName = !1, !1) } function validateEmail(e) { return (e = e).match(/^([a-zA-Z0-9_\-\.]+)@([a-zA-Z0-9_\-\.]+)\.([a-zA-Z]{2,5})$/) ? ($("#txtEmail1").next().removeClass("ion-alert-circled"), isValidEmail = !0, !0) : ($("#txtEmail1").addClass("ion-alert-circled"), isValidEmail = !1, !1) } function validatePhone(e) { return console.log("Phone being validated"), /^\d{10}$/.test(e) ? (isValidPhoneNumber = !0, $("#txtPhoneNumber").removeClass("ion-alert-circled"), !0) : (isValidPhoneNumber = !1, $("#txtPhoneNumber").addClass("ion-alert-circled"), !1) } function sendSubscriptions() { var e = txtUserName.value, a = txtEmail1.value, s = txtPhone.value, i = txtMessage.value; globalEmail = a, validateEmail(a), validatePhone(s), validateName(e); i = { Name: e, Email: a, Phone: s, userMessage: i }; if (isValidName && isValidEmail && isValidPhoneNumber) { $.ajax({ type: "POST", url: "services.asmx/sendMessage", data: "{Message: '" + JSON.stringify(i) + "'}", contentType: "application/json; charset=utf-8", dataType: "json", success: function (e) { getUserMessage(a) }, error: function (e) { } }), $("#card").flip("toggle"), $("#subscribeForm").attr("hidden", "hidden") } else alert("Please check your info before submitting.") } function getUserMessage(e) { console.log("get message called"), console.log(e), $.ajax({ type: "POST", url: "services.asmx/getMessage", data: "{email: '" + e + "'}", contentType: "application/json; charset=utf-8", dataType: "json", success: function (e) { fillCard({ Name: e.d.Name, Email: e.d.Email, Message: e.d.userMessage }) }, error: function (e) { alert(e) } }) } function fillCard(e) { $("#pLead").text("Thank you! " + e.Name + ". Your message: "), $("#pMessage").text(e.Message), $("#pHelper").text("has been received."), $("#pTrail").text("To add your email '" + e.Email + " 'to our mailing list, please click on the button below.") } function sendEmail() { console.log("send email called"), $(".back").css("font-size", "42px"), $.ajax({ type: "POST", url: "services.asmx/SendEmail", data: "{email: '" + globalEmail + "'}", contentType: "application/json; charset=utf-8", dataType: "json", success: function (e) { var a = { Name: e.d.Name, Email: e.d.Email, Message: e.d.userMessage }; $(".back").text("Email sent to " + globalEmail + "."), $(".back").css("font-size", "42px"), fillCard(a) }, error: function (e) { alert(e), console.log("error") } }) } $("#card").flip({ trigger: "manual" });